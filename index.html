<!-- Adicionar na seção de upload -->
<div id="loadingIndicator" style="display: none; margin-top: 10px;">
    <div style="display: inline-block; margin-right: 10px;">Processando...</div>
    <div class="spinner" style="display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(0,0,0,0.1); border-radius: 50%; border-top-color: #3498db; animation: spin 1s ease-in-out infinite;"></div>
</div>

<style>
@keyframes spin {
    to { transform: rotate(360deg); }
}
</style>

<script>
function processFile() {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0];
    
    if (!file) {
        alert('Por favor, selecione um arquivo primeiro.');
        return;
    }
    
    // Mostrar indicador de carregamento
    document.getElementById('loadingIndicator').style.display = 'block';
    document.getElementById('processBtn').disabled = true;
    
    const reader = new FileReader();
    
    reader.onload = function(e) {
        try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            const firstSheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[firstSheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet);
            
            analyzeData(jsonData);
            document.getElementById('results').style.display = 'block';
        } catch (error) {
            alert('Erro ao processar o arquivo: ' + error.message);
        } finally {
            document.getElementById('loadingIndicator').style.display = 'none';
            document.getElementById('processBtn').disabled = false;
        }
    };
    
    reader.onerror = function() {
        alert('Erro ao ler o arquivo.');
        document.getElementById('loadingIndicator').style.display = 'none';
        document.getElementById('processBtn').disabled = false;
    };
    
    reader.readAsArrayBuffer(file);
}
</script>
